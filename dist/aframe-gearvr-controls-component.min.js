!function(t){function e(o){if(n[o])return n[o].exports;var s=n[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var n=AFRAME.utils.bind,o=AFRAME.utils.trackedControls.getGamepadsByPrefix,s="Gear VR Touchpad";AFRAME.utils.gearvrControls={isSamsungInternetBrowser:function(){return navigator.userAgent.indexOf(" SamsungBrowser/")>=0},isControllerPresent:function(){if(AFRAME.utils.gearvrControls.isSamsungInternetBrowser())return!0;var t=AFRAME.utils.trackedControls.getGamepadsByPrefix("Gear VR Touchpad");return t&&t.length>0}},AFRAME.registerComponent("gearvr-controls",{dependencies:["tracked-controls"],multiple:!1,schema:{hand:{default:"right"},model:{default:"false"},rotationOffset:{default:0}},mapping:{axis0:"trackpad",axis1:"trackpad",button0:"trackpad"},bindMethods:function(){this.onModelLoaded=n(this.onModelLoaded,this),this.checkIfControllerPresent=n(this.checkIfControllerPresent,this),this.onGamepadConnected=n(this.onGamepadConnected,this),this.onGamepadDisconnected=n(this.onGamepadDisconnected,this),this.onTouchStart=n(this.onTouchStart,this),this.onMouseMove=n(this.onMouseMove,this),this.onTouchEnd=n(this.onTouchEnd,this)},init:function(){this.buttonStates={},this.previousAxis=[],this.animationActive="pointing",this.controllerPresent=!1,this.bindMethods(),this.getGamepadsByPrefix=o,this.isSamsungInternetBrowser=AFRAME.utils.gearvrControls.isSamsungInternetBrowser(),this.isSamsungInternetBrowser&&(this.controller=this.fauxController={buttons:[{pressed:!1}],axes:[0,0]})},onTouchStart:function(){this.fauxController.buttons[0].pressed=!0},onTouchEnd:function(){this.fauxController.buttons[0].pressed=!1},onMouseMove:function(t){this.fauxController.axes[0]=2*t.screenX/window.screen.width-1,this.fauxController.axes[1]=2*t.screenY/window.screen.height-1},addControllerAttributes:function(){this.el.setAttribute("look-controls",""),this.isSamsungInternetBrowser&&(window.addEventListener("touchstart",this.onTouchStart,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("touchend",this.onTouchEnd,!1))},removeControllerAttributes:function(){this.el.removeAttribute("look-controls"),this.isSamsungInternetBrowser&&(window.removeEventListener("touchstart",this.onTouchStart,!1),window.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("touchend",this.onTouchEnd,!1))},getControllerIfPresent:function(){var t=this.getGamepadsByPrefix(s);if(t&&t.length)return t[0]},checkIfControllerPresent:function(){var t=this.getControllerIfPresent(),e=!!t;t&&(this.controller=t),this.isSamsungInternetBrowser&&(e=!0),e!==this.controllerPresent&&(this.controllerPresent=e,e?this.addControllerAttributes():this.removeControllerAttributes())},tick:function(){var t=new THREE.Vector3;return function(){if(this.checkIfControllerPresent(),this.controllerPresent){t.copy(this.el.sceneEl.camera.el.object3D.position);var e=new THREE.Vector3("left"===this.data.hand?-.15:.15,-.25,-.15);e.applyAxisAngle(this.el.object3D.up,this.el.object3D.rotation.y),t.add(e),this.el.setAttribute("position",{x:t.x,y:t.y,z:t.z}),this.el.object3D.rotation.z+=this.data.rotationOffset,this.updateButtons()}}}(),updateButtons:function(){var t,e,n=this.controller;if(this.controller){for(t=0;t<n.buttons.length;++t)e=n.buttons[t],this.handleButton(t,e);this.handleAxes(n.axes)}},handleAxes:function(t){var e,n=this.previousAxis,o=!1;for(e=0;e<t.length;++e)if(n[e]!==t[e]){o=!0;break}o&&(this.previousAxis=t.slice(),this.el.emit("axismove",{axis:this.previousAxis}))},handleButton:function(t,e){var n=!1;n=n||this.handlePress(t,e),n=n||this.handleTouch(t,e),n=n||this.handleValue(t,e),n&&this.el.emit("buttonchanged",{id:t,state:e})},handlePress:function(t,e){var n=this.buttonStates,o=n[t]=n[t]||{},s=e.pressed,r=this.previousAxis;return!this.isSamsungInternetBrowser&&r&&r.length>1&&r[1]&&(s=!0),s!==o.pressed&&(this.onButtonEvent(t,s?"down":"up"),o.pressed=s,!0)},handleTouch:function(t,e){var n=this.buttonStates,o=e.touched?"start":"end",s=n[t]=n[t]||{};return e.touched!==s.touched&&(s.touched=e.touched,this.onButtonEvent(t,"touch"+o),!0)},handleValue:function(t,e){var n=this.buttonStates,o=n[t]=n[t]||{};return e.value!==o.value&&(o.value=e.value,!0)},onGamepadConnected:function(t){this.checkIfControllerPresent()},onGamepadDisconnected:function(t){this.checkIfControllerPresent()},play:function(){this.checkIfControllerPresent(),window.addEventListener("gamepadconnected",this.onGamepadConnected,!1),window.addEventListener("gamepaddisconnected",this.onGamepadDisconnected,!1)},pause:function(){window.removeEventListener("gamepadconnected",this.onGamepadConnected,!1),window.removeEventListener("gamepaddisconnected",this.onGamepadDisconnected,!1),this.removeControllerAttributes()},onButtonEvent:function(t,e){var n,o=this.mapping["button"+t];if(Array.isArray(o))for(n=0;n<o.length;n++)this.el.emit(o[n]+e);else this.el.emit(o+e)}})}]);